## 基础

### 媒体格式（Media Formats）

媒体格式定义了数字媒体文件的容器结构，用于存储`音频`、`视频`、`字幕`和其他相关数据。常见的媒体格式包括：
- **MP4（MPEG-4 Part 14）**：一种常见的数字媒体文件容器格式，支持存储视频、音频和字幕流，常用于在线视频分享平台和移动设备。
- **WebM**：一种开放的媒体容器格式，通常用于网络视频流传输，支持 VP8、VP9 和 AV1 视频编码，以及 Vorbis 和 Opus 音频编码。
- **AVI（Audio Video Interleave）**：一种由微软开发的多媒体容器格式，支持多种音频和视频编码，常用于 Windows 平台。
- **Matroska（.mkv）**：一种开源的多媒体容器格式，支持存储几乎所有类型的媒体数据，包括高清视频、音频和字幕。

### 视频编码（Video Codecs）

视频编码是将视频数据进行压缩编码的过程，以减小文件大小并提高传输效率。常见的视频编码器（Video Codecs）包括：

- **H.264/AVC**：一种广泛使用的视频压缩编码标准，提供高质量的视频压缩和较低的比特率，适用于各种应用场景，包括在线视频流媒体、蓝光光盘和视频通信。
- **H.265/HEVC**：高效视频编码标准的继任者，提供`更高的压缩效率`和`更好的视频质量`，适用于 4K、8K 视频和高分辨率视频流传输。
- **VP9**：Google 开发的开源视频编码器，用于 WebM 格式的视频编码，提供高效的压缩和高质量的视频，适用于网络视频流媒体。
- **AV1**：由 Alliance for Open Media 开发的开源视频编码器，旨在提供更高的压缩效率和更好的视频质量，适用于网络视频流媒体和高分辨率视频。


### 音频编码（Audio Codecs）

音频编码是将音频数据进行压缩编码的过程，以减小文件大小并提高传输效率。常见的音频编码器（Audio Codecs）包括：

- **AAC（Advanced Audio Coding）**：一种常见的音频压缩编码标准，提供高质量的音频压缩和广泛的兼容性，适用于在线音乐流媒体和移动设备。
- **MP3（MPEG Audio Layer III）**：一种流行的音频压缩编码格式，广泛用于数字音乐播放器和在线音乐分享平台。
- **Opus**：一种开放的音频编码格式，提供高质量的音频压缩和低延迟，适用于网络音频流媒体和实时通信。

## 术语

### 1. 分辨率
视频的分辨率通常表示为宽度 x 高度（例如，1920x1080），表示视频图像的水平像素数量和垂直像素数量。分辨率的像素总数可以通过以下公式计算：

```
像素总数 = 宽度 x 高度
```


| 视频分辨率     | 分辨率          | 总像素数      | 适合设备                                    |
|----------------|----------------|---------------|--------------------------------------------|
| 高清（HD）      | 1280 x 720     | 921,600       | 平板电脑、笔记本电脑、小尺寸电视、智能手机   |
| 全高清（Full HD） | 1920 x 1080   | 2,073,600     | 电视、显示器、笔记本电脑、游戏主机         |
| 2K             | 2560 x 1440    | 3,686,400     | 高端显示器、电视、专业视频编辑设备         |
| 4K（UHD）      | 3840 x 2160    | 8,294,400     | 大屏电视、高端显示器、专业视频编辑设备     |
| 8K             | 7680 x 4320    | 33,177,600    | 高端专业显示器、特定的专业视频编辑设备     |

> 分辨率越高,包含的像素就越多,视频画面就越细腻清晰,但文件体积也越大

### 2. 帧率
视频的帧率表示每秒显示的图像数量。帧率通常以帧每秒（fps）为单位。帧率的计算不涉及像素，但它是视频像素计算的重要组成部分，因为它影响了视频的播放流畅度和视觉质量。
* 常见的有24fps、30fps、60fps等。
* 帧率越高,画面就越流畅,但文件体积也越大。帧率不会影响画面清晰度。

### 3. 总像素
视频的总像素数可以通过将每帧的像素数乘以帧率来计算，这给出了每秒钟的总像素数。

```
总像素数 = 像素总数 x 帧率
```
### 4. 宽高比
宽高比是视频画面宽度与高度的比值,常见的有16:9、4:3等。
给定分辨率和宽高比,就可以计算出视频画面的总像素数。

### 5. 比特深度(Bit Depth)
比特深度是指数字音频或视频中每个采样点或像素所使用的二进制位数。比特深度决定了数字信号能够表示的最大动态范围和细节程度。比特深度决定了数字信号能够表示的最大动态范围和细节程度。
* 对于数字音频,比特深度指的是:
  * 每个采样点使用的比特数,用于重现模拟音频信号的振幅。
  * 比特深度越高,动态范围就越大,能够表示更精细的音频细节和更低的噪声底限。
  * 常见的音频比特深度有16位(CD标准)和24位(高分辨率音频),24位比特深度的动态范围更大,信噪比更高。
  * 更高的比特深度(如32位或64位)虽然理论上更精确,但由于人耳听力的局限性,与24位相比优势不明显。
* 对于数字视频和图像,比特深度指的是:
  * 每个像素使用的比特数,用于表示颜色深度和色阶。
  * 比特深度越高,能够表示的颜色级别就越多,图像或视频的色彩就越细腻逼真。
  * 常见的色彩深度有8位(256种颜色)、16位(65536种颜色)和24位(1600多万种颜色)。
 
  比特率（Bitrate）：比特率是指视频或音频数据在单位时间内传输或处理的数据量，通常以每秒的比特数（bps）表示。在视频处理中，比特率通常用来衡量视频的编码质量和文件大小。对于音频处理也是如此。

### 6. 码率
码率指每秒传输的数据量,单位通常为kbps。
* 码率越高,视频画面就越接近原始分辨率,画质越好,但文件体积也越大。
* 码率的单位通常使用kbps或mbps,1kbps=1000bps,1mbps=1000kbps。
* 码率越高,视频质量越好,但文件体积也越大。

```
未压缩视频码率 = 音频码率 + 视频图像码率
视频图像码率 = 分辨率(像素) x 帧率 x 比特深度
```

```
压缩后的视频码率 = 音频码率 x 音频压缩比率 + 视频图像码率 x 视频压缩比率
```
> H.264压缩比率约为1/50 ~ 1/100
> H.265压缩比率约为1/100 ~ 1/200

视频编码格式
不同的视频编码格式如H.264、H.265、VP9等,具有不同的压缩率和质量参数。
压缩率越高,视频文件体积越小,但画质也会有所损失。
因此,要获得理想的视频质量和合理的文件大小,需要在分辨率、帧率、码率和编码格式之间寻找平衡。通常采用较高的分辨率(如1080p)、适中的帧率(如30fps)和码率,以及较新高效的编码格式(如H.265),可以在质量和大小之间取得较好的折中。

### 7. 采样率（Sampling Rate）
采样率是指在`数字音频`中采集和处理声音信号时,对声音信号进行采样的频率。采样率使用赫兹(Hz)来表示,即表示每秒采集多少个样本
采样率越高,就意味着每秒采集的声音样本数目越多,能够更精确地捕捉模拟声音信号。
常见的音频采样率有:
44.1kHz - CD标准采样率
48kHz - 常用于电影和数字电视音频
96kHz - 高分辨率音频采样率
192kHz - 专业录音工作室使用的高采样率

### 8. 比特率



## 代码

### 视频参数查看
```sh
ffmpeg -i input.mp4
```

### 将字幕放入视频里
```sh
ffmpeg -i [视频] -vf 'ass=[字幕文件]'  -map 0:v -map 0:a -c:v libx264 -c:a copy [输出]
```
>-map 0:v：选择输入文件的视频流。0 表示第一个输入文件，v 表示视频流。
>-map 0:a：选择输入文件的音频流。0 表示第一个输入文件，a 表示音频流。
>-c:v libx264：选择视频编码器。在这个命令中，我们选择了 libx264，它是一个常用的 H.264 视频编码器。
>-c:a copy：选择音频编码器。在这个命令中，我们选择了 copy，表示音频流会直接复制到输出文件中，不进行重新编码。

**指定时长**
```sh
ffmpeg -i [视频] -vf 'ass=[字幕文件]'  -t 00:01:00 -map 0:v -map 0:a -c:v libx264 -c:a copy [输出]
```

**添加gpu**
```shffmpeg -hwaccel cuvid -c:v h264_cuvid -i [视频] -vf 'ass=[字幕文件]' -map 0:v -map 0:a -c:v h264_nvenc -c:a copy [输出]```
>-hwaccel cuda: 指定使用 CUDA 加速器来加速解码。
>-c:v h264_nvenc: 指定使用 NVENC 编码器来进行 H.264 编码。这将利用 NVIDIA GPU 上的硬件编码器来加速转码过程。
**断点续传**
